import{_ as e,ak as t,p as o,al as r,o as a,am as n,an as s,e as c,s as i,a as l,J as u,L as d,i as h,b as $,M as g,n as p,f,O as m,G as k,h as v,j as b,k as C,I as x,K as y,c as w,m as T,t as W,a4 as S,a5 as R,a6 as z,d as O,g as N,ao as E,a8 as _,a9 as q,S as P,B as A,ap as I,aq as L,R as j,r as B,C as F,ai as M,T as U}from"./index-bd561abb.js";import{B as G,T as K}from"./businesser-730e53ca.js";import{F as Q}from"./FillOrTwoToneButton-6a4f7cb8.js";var Z,H=e,J=t.f,V=o,X=r,D=a,Y=n,ee=s,te="".startsWith,oe=Math.min,re=Y("startsWith");H({target:"String",proto:!0,forced:!!(ee||re||(Z=J(String.prototype,"startsWith"),!Z||Z.writable))&&!re},{startsWith:function(e){var t=String(D(this));X(e);var o=V(oe(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return te?te.call(t,r,o):t.slice(o,o+r.length)===r}});function ae(e){var t,o,r,a,n,s;return{c(){t=c("label"),o=c("input"),r=i(),a=c("span"),l(o,"type","checkbox"),l(o,"class","svelte-1l9dp6"),l(a,"class","slider svelte-1l9dp6"),l(t,"class","switch svelte-1l9dp6"),u(t,"--colour-background",d.parse(e[2])),u(t,"--colour-knob",d.parse(e[4])),u(t,"--colour-checked",d.parse(e[3])),u(t,"--height",d.parse(e[5])),u(t,"--width",d.parse(e[6])),u(t,"--knob-size",d.parse(e[7]))},m(c,i){h(c,t,i),$(t,o),o.checked=e[0],$(t,r),$(t,a),n||(s=g(o,"change",e[9]),n=!0)},p(e,r){var[a]=r;1&a&&(o.checked=e[0]),4&a&&u(t,"--colour-background",d.parse(e[2])),16&a&&u(t,"--colour-knob",d.parse(e[4])),8&a&&u(t,"--colour-checked",d.parse(e[3])),32&a&&u(t,"--height",d.parse(e[5])),64&a&&u(t,"--width",d.parse(e[6])),128&a&&u(t,"--knob-size",d.parse(e[7]))},i:p,o:p,d(e){e&&f(t),n=!1,s()}}}function ne(e,t,o){var r,a=p,n=()=>(a(),a=m(c,(e=>o(8,r=e))),c);e.$$.on_destroy.push((()=>a()));var{isChecked:s=!1}=t,{isCheckedW:c=k(s)}=t;n();var{backgroundColour:i="--colour-background-secondary"}=t,{checkedColour:l="--colour-accent-secondary"}=t,{knobColour:u="--colour-text-primary"}=t,{height:d=32}=t,{width:h=56}=t,{knobSize:$=32}=t;return e.$$set=e=>{"isChecked"in e&&o(0,s=e.isChecked),"isCheckedW"in e&&n(o(1,c=e.isCheckedW)),"backgroundColour"in e&&o(2,i=e.backgroundColour),"checkedColour"in e&&o(3,l=e.checkedColour),"knobColour"in e&&o(4,u=e.knobColour),"height"in e&&o(5,d=e.height),"width"in e&&o(6,h=e.width),"knobSize"in e&&o(7,$=e.knobSize)},e.$$.update=()=>{256&e.$$.dirty&&o(0,s=r),3&e.$$.dirty&&c.set(s)},[s,c,i,l,u,d,h,$,r,function(){s=this.checked,o(0,s),o(8,r)}]}class Switch extends v{constructor(e){super(),b(this,e,ne,ae,C,{isChecked:0,isCheckedW:1,backgroundColour:2,checkedColour:3,knobColour:4,height:5,width:6,knobSize:7})}get isChecked(){return this.$$.ctx[0]}set isChecked(e){this.$set({isChecked:e}),x()}get isCheckedW(){return this.$$.ctx[1]}set isCheckedW(e){this.$set({isCheckedW:e}),x()}get backgroundColour(){return this.$$.ctx[2]}set backgroundColour(e){this.$set({backgroundColour:e}),x()}get checkedColour(){return this.$$.ctx[3]}set checkedColour(e){this.$set({checkedColour:e}),x()}get knobColour(){return this.$$.ctx[4]}set knobColour(e){this.$set({knobColour:e}),x()}get height(){return this.$$.ctx[5]}set height(e){this.$set({height:e}),x()}get width(){return this.$$.ctx[6]}set width(e){this.$set({width:e}),x()}get knobSize(){return this.$$.ctx[7]}set knobSize(e){this.$set({knobSize:e}),x()}}function se(e){var t;return{c(){(t=c("string")).textContent="Login",l(t,"class","svelte-8qcxxd"),y(t,"active",!e[0])},m(e,o){h(e,t,o)},p(e,o){1&o&&y(t,"active",!e[0])},d(e){e&&f(t)}}}function ce(e){var t;return{c(){(t=c("string")).textContent="Register",l(t,"class","svelte-8qcxxd"),y(t,"active",e[0])},m(e,o){h(e,t,o)},p(e,o){1&o&&y(t,"active",e[0])},d(e){e&&f(t)}}}function ie(e){var t,o,r,a,n,s,u,d;return(o=new Q({props:{backgroundColour:e[0]?"--colour-background-secondary":"--colour-accent-secondary",icon:"login",isTwoTone:e[0],fillColour:e[0]?"--colour-text-secondary":"--colour-accent-primary",iconSize:"1.4rem",$$slots:{default:[se]},$$scope:{ctx:e}}})).$on("click",e[13]),(s=new Q({props:{backgroundColour:e[0]?"--colour-accent-secondary":"--colour-background-secondary",icon:"person_add",isTwoTone:!e[0],fillColour:e[0]?"--colour-accent-primary":"--colour-text-secondary",iconSize:"1.4rem",$$slots:{default:[ce]},$$scope:{ctx:e}}})).$on("click",e[14]),{c(){t=c("container"),w(o.$$.fragment),a=i(),n=c("container"),w(s.$$.fragment),l(t,"class","login svelte-8qcxxd"),l(t,"_",e[0]),l(n,"class","register svelte-8qcxxd"),l(n,"_",e[0])},m(e,r){h(e,t,r),T(o,t,null),h(e,a,r),h(e,n,r),T(s,n,null),d=!0},p(e,r){var a={};1&r&&(a.backgroundColour=e[0]?"--colour-background-secondary":"--colour-accent-secondary"),1&r&&(a.isTwoTone=e[0]),1&r&&(a.fillColour=e[0]?"--colour-text-secondary":"--colour-accent-primary"),2097153&r&&(a.$$scope={dirty:r,ctx:e}),o.$set(a),(!d||1&r)&&l(t,"_",e[0]);var c={};1&r&&(c.backgroundColour=e[0]?"--colour-accent-secondary":"--colour-background-secondary"),1&r&&(c.isTwoTone=!e[0]),1&r&&(c.fillColour=e[0]?"--colour-accent-primary":"--colour-text-secondary"),2097153&r&&(c.$$scope={dirty:r,ctx:e}),s.$set(c),(!d||1&r)&&l(n,"_",e[0])},i(e){d||(W(o.$$.fragment,e),r||S((()=>{(r=R(t,z,{})).start()})),W(s.$$.fragment,e),u||S((()=>{(u=R(n,z,{delay:100})).start()})),d=!0)},o(e){O(o.$$.fragment,e),O(s.$$.fragment,e),d=!1},d(e){e&&f(t),N(o),e&&f(a),e&&f(n),N(s)}}}function le(e){var t,o,r,a,n,s,u;return t=new E({props:{title:"Confirm Password",label:"Confirm Password",type:"password",buttonComponent:null,valueW:e[3],hint:"Passwords don't match.",hintLevelW:e[7]}}),a=new Switch({props:{isCheckedW:e[4]}}),{c(){w(t.$$.fragment),o=i(),r=c("container"),w(a.$$.fragment),n=i(),(s=c("string")).innerHTML='I hereby agree to the <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" class="svelte-8qcxxd">Terms and Conditions</a>.',l(s,"class","svelte-8qcxxd"),l(r,"class","boring svelte-8qcxxd")},m(e,c){T(t,e,c),h(e,o,c),h(e,r,c),T(a,r,null),$(r,n),$(r,s),u=!0},p:p,i(e){u||(W(t.$$.fragment,e),W(a.$$.fragment,e),u=!0)},o(e){O(t.$$.fragment,e),O(a.$$.fragment,e),u=!1},d(e){N(t,e),e&&f(o),e&&f(r),N(a)}}}function ue(e){var t,o,r,a,n,s,u;o=new E({props:{title:"Email",label:"Email",buttonComponent:null,valueW:e[1],hint:"Invalid email.",hintLevelW:e[5]}}),a=new E({props:{title:"Password",label:"Password",type:"password",buttonComponent:null,valueW:e[2],hint:"Passwords should be longer than 6 letters.",hintLevelW:e[6]}});var d=e[0]&&le(e);return{c(){t=c("container"),w(o.$$.fragment),r=i(),w(a.$$.fragment),n=i(),d&&d.c(),l(t,"class","form svelte-8qcxxd"),l(t,"_",e[0]),y(t,"register",e[0])},m(e,s){h(e,t,s),T(o,t,null),$(t,r),T(a,t,null),$(t,n),d&&d.m(t,null),u=!0},p(e,o){e[0]?d?(d.p(e,o),1&o&&W(d,1)):((d=le(e)).c(),W(d,1),d.m(t,null)):d&&(_(),O(d,1,1,(()=>{d=null})),q()),(!u||1&o)&&l(t,"_",e[0]),1&o&&y(t,"register",e[0])},i(e){u||(W(o.$$.fragment,e),W(a.$$.fragment,e),W(d),s||S((()=>{(s=R(t,z,{})).start()})),u=!0)},o(e){O(o.$$.fragment,e),O(a.$$.fragment,e),O(d),u=!1},d(e){e&&f(t),N(o),N(a),d&&d.d()}}}function de(e){var t,o,r,a,n,s,u,d,$,g=e[0],m=e[0],k=ie(e);r=new P({props:{height:56}});var v=ue(e);return s=new P({props:{height:112}}),(d=new A({props:{icon:"arrow_forward"}})).$on("click",e[8]),{c(){t=c("container"),k.c(),o=i(),w(r.$$.fragment),a=i(),v.c(),n=i(),w(s.$$.fragment),u=i(),w(d.$$.fragment),l(t,"class","buttons svelte-8qcxxd")},m(e,c){h(e,t,c),k.m(t,null),h(e,o,c),T(r,e,c),h(e,a,c),v.m(e,c),h(e,n,c),T(s,e,c),h(e,u,c),T(d,e,c),$=!0},p(e,o){1&o&&C(g,g=e[0])?(_(),O(k,1,1,p),q(),(k=ie(e)).c(),W(k),k.m(t,null)):k.p(e,o),1&o&&C(m,m=e[0])?(_(),O(v,1,1,p),q(),(v=ue(e)).c(),W(v),v.m(n.parentNode,n)):v.p(e,o)},i(e){$||(W(k),W(r.$$.fragment,e),W(v),W(s.$$.fragment,e),W(d.$$.fragment,e),$=!0)},o(e){O(k),O(r.$$.fragment,e),O(v),O(s.$$.fragment,e),O(d.$$.fragment,e),$=!1},d(e){e&&f(t),k.d(e),e&&f(o),N(r,e),e&&f(a),v.d(e),e&&f(n),N(s,e),e&&f(u),N(d,e)}}}function he(e){var t,o;return t=new I({props:{isPadded:!0,isInAnimated:!0,isOutAnimated:!0,height:"100vh",width:"100%",align:"flex-start",justify:"center",rows:"min-content min-content 1fr",appBarComponent:L,$$slots:{default:[de]},$$scope:{ctx:e}}}),{c(){w(t.$$.fragment)},m(e,r){T(t,e,r),o=!0},p(e,o){var[r]=o,a={};2097153&r&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){o||(W(t.$$.fragment,e),o=!0)},o(e){O(t.$$.fragment,e),o=!1},d(e){N(t,e)}}}var $e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;function ge(e,t,o){var r,a,n,s,c,i,l,u,d=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))((function(a,n){function s(e){try{i(r.next(e))}catch(e){n(e)}}function c(e){try{i(r.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}i((r=r.apply(e,t||[])).next())}))},h=!1,$=k("");j(e,$,(e=>o(9,r=e)));var g=k("");j(e,g,(e=>o(10,n=e)));var p=k("");j(e,p,(e=>o(12,i=e)));var f=k(!1);j(e,f,(e=>o(19,l=e)));var m=k(0);j(e,m,(e=>o(17,a=e)));var v=k(0);j(e,v,(e=>o(18,s=e)));var b=k(0);j(e,b,(e=>o(11,c=e))),G.initializeFirebase(),G.once("authenticate",(e=>{var{data:t}=e;return d(void 0,void 0,void 0,(function*(){var e=yield t.getIdToken(!0);G.createContexts(e),yield G.createGlobalSocket(e),(yield t.getIdTokenResult()).claims.identityValidated?(yield B("/dashboard"),F.globalToasts=[K.from({duration:3e3,level:M.OK,text:"Successfully logged in!"}),...F.globalToasts]):yield B("/verify")}))}));for(var C=0,x=localStorage.length;C<x;++C)if(null===(u=localStorage.key(C))||void 0===u?void 0:u.startsWith("firebase:authUser:")){F.globalToasts=[K.from({duration:3e3,text:"Authenticating using local session..."}),...F.globalToasts];break}return e.$$.update=()=>{512&e.$$.dirty&&(!r||$e.test(r)?U(m,a=M.NONE,a):U(m,a=M.ERROR,a)),1024&e.$$.dirty&&(!n||n.length>6?U(v,s=M.NONE,s):U(v,s=M.ERROR,s)),7168&e.$$.dirty&&U(b,c=c&&i!==n?M.ERROR:M.NONE,c)},[h,$,g,p,f,m,v,b,function(){return d(this,void 0,void 0,(function*(){if(a===M.NONE&&s===M.NONE&&r&&n&&(!h||c===M.NONE)&&(!h||i)&&(!h||l)){F.globalToasts=[K.from({duration:3e3,text:"Working..."}),...F.globalToasts];h?yield G.registerUser(r,n):yield G.loginUser(r,n)}else F.globalToasts=[K.from({level:M.ERROR,text:"The form is still incomplete, unfortunately."}),...F.globalToasts]}))},r,n,c,i,()=>o(0,h=!1),()=>o(0,h=!0)]}export default class AuthenticateRoute extends v{constructor(e){super(),b(this,e,ge,he,C,{})}}
